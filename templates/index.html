{% extends 'layout.html' %}

{% block body %}

<!-- Barra de búsqueda -->
<section class="search-bar">
    <form action="/search" method="get" class="search-form">
        <input type="text" name="q" placeholder="Buscar..." class="search-input">
        <button type="submit" class="search-button">Buscar</button>
    </form>
</section>

<!-- Contenedor principal -->
<main class="main-container">
    <div class="columns-row">
        
        <!-- Columna izquierda: Formulario -->
        <div class="column column-form">
            <!-- Mensajes Flash -->
            {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                <div class="alert-message">
                    <span>{{ message }}</span>
                    <button type="button" class="btn-close" onclick="this.parentElement.style.display='none'">×</button>
                </div>
                {% endfor %}
            {% endif %}
            {% endwith %}

            <!-- Card Registrar Producto -->
            <div class="card card-form">
                <div class="card-header">
                    <h5>Registrar Producto</h5>
                </div>
                <div class="card-body">
                    <form action="/add_product" method="POST" class="product-form">
                        <label for="nombre">Nombre:</label>
                        <input type="text" id="nombre" name="nombre" minlength="4" class="form-control" required>

                        <label for="precio">Precio:</label>
                        <input type="number" id="precio" name="precio" step="0.01" min="1" class="form-control" required>

                        <label for="cantidad">Cantidad:</label>
                        <input type="number" id="cantidad" name="cantidad" min="1" class="form-control" required>

                        <button type="submit" class="btn-primary">Guardar</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Columna derecha: Tabla -->
        <div class="column column-table">
            <div class="card card-table">
                <div class="card-header">
                    <h5>Lista de Productos</h5>
                </div>
                <div class="table-wrapper">
                    <table class="product-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>Operación</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for product in dataProducts %}
                            <tr>
                                <td class="product-name">{{ product.nombre }}</td>
                                <td>{{ product.precio }}</td>
                                <td>{{ product.cantidad }}</td>
                                <td>
                                    <a href="/edit_products/{{ product._id }}" class="btn-secondary">Editar</a>
                                    <a href="/delete_product/{{ product._id }}" class="btn-delete">Eliminar</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</main>

{% endblock %}
